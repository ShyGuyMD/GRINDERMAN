<form [formGroup]="clientForm" (ngSubmit)="save()" class="p-mt-4">
  <div *ngIf="isLoading; else showForm">
    <p-progressSpinner></p-progressSpinner>
  </div>
  <ng-template #showForm>
    <div class="p-fluid">
      <div class="p-field">
        <label for="client-email">Email:</label>
        <input
          type="email"
          id="client-email"
          pInputText
          formControlName="email"
          name="email"
          required
          (blur)="validateEmail()"
        />
        <div *ngIf="clientForm.get('email')?.invalid && clientForm.get('email')?.touched" class="p-error">
          <ng-container *ngIf="clientForm.get('email')?.hasError('required')">
            Email is required.
          </ng-container>
          <ng-container *ngIf="clientForm.get('email')?.hasError('email')">
            Invalid email format.
          </ng-container>
        </div>
        <div *ngIf="registrationError" class="p-error">
          Existing email.
        </div>
      </div>
      <div class="p-field">
        <label for="client-password">Password:</label>
        <input
          type="password"
          id="client-password"
          pPassword
          formControlName="password"
          required
          (blur)="validatePassword()"
        />
        <div *ngIf="clientForm.get('password')?.invalid && clientForm.get('password')?.touched" class="p-error">
          <ng-container *ngIf="clientForm.get('password')?.hasError('required')">
            Password is required.
          </ng-container>
          <ng-container *ngIf="clientForm.get('password')?.hasError('passwordInvalid')">
            Password must be at least 12 characters long and contain at least one uppercase letter, one lowercase letter, one number, and one special character (@#$%^&+=).
          </ng-container>
        </div>
      </div>
      <!-- Double password field and error message for password mismatch -->
      <div class="p-field">
        <label for="client-confirm-password">Confirm Password:</label>
        <input
          type="password"
          id="client-confirm-password"
          pPassword
          formControlName="confirmPassword"
          required
          (blur)="validatePasswordMatch()"
        />
        <div *ngIf="clientForm.get('confirmPassword')?.value !== clientForm.get('password')?.value && clientForm.get('confirmPassword')?.touched" class="p-error">
          Passwords do not match.
        </div>
      </div>
    </div>
    <div class="p-formgroup-inline mt-4">
      <button type="submit" class="p-button">Registrar</button>
    </div>
  </ng-template>
</form>
