<app-section-title title="Alta de Administrador"></app-section-title>
<div class="user-create">
  <p>
    Completa este formulario para crear un nuevo administrador.
  </p>
  <form [formGroup]="adminForm" (ngSubmit)="save()" class="p-mt-4">
    <div>
      <div class="p-fluid">
        <div class="p-field">
          <label for="client-firstname">Nombre:</label>
          <input
            type="text"
            id="client-firstname"
            pInputText
            formControlName="firstname"
            name="firstname"
            required
          />
          <div
            *ngIf="
              adminForm.get('firstname')?.invalid &&
              adminForm.get('firstname')?.touched
            "
            class="p-error"
          >
            <ng-container
              *ngIf="adminForm.get('firstname')?.hasError('required')"
            >
              El nombre es obligatorio.
            </ng-container>
          </div>
        </div>
        <div class="p-field">
          <label for="client-lastname">Apellido:</label>
          <input
            type="text"
            id="client-lastname"
            pInputText
            formControlName="lastname"
            name="lastname"
            required
          />
          <div
            *ngIf="
              adminForm.get('lastname')?.invalid &&
              adminForm.get('lastname')?.touched
            "
            class="p-error"
          >
            <ng-container
              *ngIf="adminForm.get('lastname')?.hasError('required')"
            >
              El apellido es obligatorio.
            </ng-container>
          </div>
        </div>
        <div class="p-field">
          <label for="admin-email">Email:</label>
          <input
            type="email"
            id="admin-email"
            pInputText
            formControlName="email"
            name="email"
            required
            (blur)="validateEmail()"
          />
          <div
            *ngIf="
              adminForm.get('email')?.invalid && adminForm.get('email')?.touched
            "
            class="p-error"
          >
            <ng-container *ngIf="adminForm.get('email')?.hasError('required')">
              El email es obligatorio.
            </ng-container>
            <ng-container *ngIf="adminForm.get('email')?.hasError('email')">
              Formato de email inválido.
            </ng-container>
          </div>
          <div *ngIf="registrationError" class="p-error">
            El email ya se encuentra registrado en nuestro sistema.
          </div>
        </div>
        <div class="p-field">
          <label for="admin-password">Contraseña:</label>
          <input
            type="password"
            id="admin-password"
            pPassword
            formControlName="password"
            required
            (blur)="validatePassword()"
          />
          <div
            *ngIf="
              adminForm.get('password')?.invalid &&
              adminForm.get('password')?.touched
            "
            class="p-error"
          >
            <ng-container
              *ngIf="adminForm.get('password')?.hasError('required')"
            >
              La constraseña es obligatoria.
            </ng-container>
            <ng-container
              *ngIf="adminForm.get('password')?.hasError('passwordInvalid')"
            >
              La constraseña debe tener al menos 12 caracteres, al menos una
              minuscula, una mayúscula, un numnero y un caracter especial
              (@#$%^&+=).
            </ng-container>
          </div>
        </div>
        <!-- Double password field and error message for password mismatch -->
        <div class="p-field">
          <label for="admin-confirm-password"
            >Confirmación de Contraseña:</label
          >
          <input
            type="password"
            id="admin-confirm-password"
            pPassword
            formControlName="confirmPassword"
            required
            (blur)="validatePasswordMatch()"
          />
          <div
            *ngIf="
              adminForm.get('confirmPassword')?.value !==
                adminForm.get('password')?.value &&
              adminForm.get('confirmPassword')?.touched
            "
            class="p-error"
          >
            Las contraseñas ingresadas no coinciden.
          </div>
        </div>
      </div>
      <div class="flex justify-content-center flex-wrap mt-4">
        <button
          type="submit"
          class="p-button flex align-items-center justify-content-center gap-2"
          pButton
          icon="pi pi-check"
          [loading]="isLoading"
          loadingIcon="pi pi-spin pi-spinner"
        >
          Registrar Administrador
        </button>
      </div>
    </div>
  </form>
</div>
