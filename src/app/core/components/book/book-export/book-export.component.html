<app-section-title title="Exportar Catálogo"></app-section-title>
<div *ngIf="isLoading; else fullCatalogue" class="w-full">
    <p-progressSpinner></p-progressSpinner>
</div>
<ng-template #fullCatalogue>
    <p-button (click)="exportToExcel()">Exportar Catálogo a Excel</p-button>
    <div class="p-grid">
        <div class="p-col-12">
          <p-table [value]="books" [paginator]="true" [rows]="rowsPerPage" [totalRecords]="totalRecords"
                   [pageLinks]="3" [currentPageReportTemplate]="'{currentPage} of {totalPages}'" (onPage)="onPageChange($event)">
            <ng-template pTemplate="header">
              <tr>
                <th pSortableColumn="id" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      ID
                      <p-sortIcon field="id"></p-sortIcon>
                      <p-columnFilter type="text" field="id" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="title" class="center-align" style="width:25%">
                    <div class="flex align-items-center justify-content-center">
                      Titulo
                      <p-sortIcon field="title"></p-sortIcon>
                      <p-columnFilter type="text" field="title" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="author" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Autor
                      <p-sortIcon field="author"></p-sortIcon>
                      <p-columnFilter type="text" field="author" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="genre" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Género
                      <p-sortIcon field="genre"></p-sortIcon>
                      <p-columnFilter type="text" field="genre" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="publisher" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Autor
                      <p-sortIcon field="publisher"></p-sortIcon>
                      <p-columnFilter type="text" field="publisher" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="availableUnits" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Available Units
                      <p-sortIcon field="availableUnits"></p-sortIcon>
                      <p-columnFilter type="text" field="availableUnits" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="price" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Price
                      <p-sortIcon field="price"></p-sortIcon>
                      <p-columnFilter type="text" field="price" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="inventoryStatus" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Inventory Status
                      <p-sortIcon field="inventoryStatus"></p-sortIcon>
                      <p-columnFilter type="text" field="inventoryStatus" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="isNew" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Estado
                      <p-sortIcon field="isNew"></p-sortIcon>
                      <p-columnFilter type="text" field="isNew" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="isHardcover" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Tapa dura
                      <p-sortIcon field="isHardcover"></p-sortIcon>
                      <p-columnFilter type="text" field="isHardcover" display="menu"></p-columnFilter>
                    </div>
                  </th>
                  <th pSortableColumn="isActive" class="center-align">
                    <div class="flex align-items-center justify-content-center">
                      Activo
                      <p-sortIcon field="isActive"></p-sortIcon>
                      <p-columnFilter type="text" field="isActive" display="menu"></p-columnFilter>
                    </div>
                  </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-book>
              <tr>
                <td>{{ book.id }}</td>
                <td>{{ book.title }}</td>
                <td>{{ book.author }}</td>
                <td>{{ listGenres(book) }}</td>
                <td>{{ book.publisher }}</td>
                <td>{{ book.availableUnits }}</td>
                <td>{{ book.price | currency }}</td>
                <td>{{ book.inventoryStatus }}</td>
                <td>{{ book.isNew ? 'Nuevo' : 'Usado' }}</td>
                <td>{{ book.isHardcover ? 'Tapa dura' : 'Tapa blanda' }}</td>
                <td>{{ book.isActive ? '✓' : '✗' }}</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
</ng-template>


  